# 상세 기능 명세서 (Detailed Feature Specification)

_이 문서는 게임 기획서(GDD)의 주요 기능들에 대한 구체적인 구현 명세를 기술합니다. GDD와 함께 참고하여 개발을 진행합니다._

---

## 1. 게임 플레이 상세

- **코어 루프 상세:**
  1.  **미션/목표 제시 (스토리 씬 또는 활동 씬):**
      - 스토리가 진행되며 특정 시점에서 클라이언트 의뢰 또는 주인공의 목표가 제시된다.
      - 미션 목표(타겟 반응 수: 좋아요, 팔로워 증가 등), 필수 키워드/해시태그, 조건(특정 인물 태그, 특정 이미지 사용 등), 제한 시간/기회 등이 제시된다. (UI: 대화창, DM, 미션 브리핑 UI 등)
      - 플레이어는 미션 수락/거절 또는 목표 설정 과정을 거쳐 인스타그램 활동 씬으로 이동할 수 있다.
  2.  **인스타그램 활동 수행 (인스타그램 활동 씬 - 가칭 `InstagramActivityScene.tsx`):**
      - **UI:** 인스타그램 앱(피드, 스토리, 프로필 등) 형태의 UI 표시 (도트 스타일).
      - **미션 정보 표시:** 화면 한 켠에 현재 미션 목표, 남은 시간/기회, 필수 키워드/조건 등을 상시 표시한다 (`MissionPanel.tsx`).
      - **반응 상태 표시:** 실시간으로 변동하는 좋아요 수, 댓글 수, 팔로워 수 등을 그래프 또는 숫자로 표시한다 (`ReactionStats.tsx` - 가칭).
      - **피드/댓글/DM 리스트:** AI가 생성한 초기 반응(댓글, DM 등) 및 플레이어 활동 결과(게시물, 댓글, DM)가 시간순 또는 알고리즘 순서(인기순 등)로 표시된다 (`InstagramFeed.tsx`, `InstagramCommentList.tsx` - 가칭). 스크롤 기능 제공.
      - **콘텐츠 게시/소통:** 플레이어는 인터페이스를 통해 콘텐츠(텍스트, 이미지 선택)를 게시하거나, 댓글/DM을 작성하고 '게시'/'전송' 버튼을 누른다 (`InstagramPostInput.tsx` - 가칭).
      - **활동 제한:** 미션에서 주어진 기회(예: 게시물 수, DM 발송 수)만큼 활동할 수 있다. (기회 차감)
      - **시간 제한:** 미션에 제한 시간이 있다면, 타이머가 표시되고 시간이 다 되면 자동으로 결과 씬으로 이동한다.
      - **AI 반응 (Should Have):** 플레이어 활동(게시물 등록, 댓글 작성 등) 시, LLM이 해당 활동을 평가하고 반응 수치(좋아요, 팔로워 등)를 업데이트하며, 새로운 AI 반응(댓글, DM 등)을 생성하여 리스트에 추가한다. 인기 게시물 순위나 노출도 변동될 수 있다.
  3.  **반응 변화 확인:** 플레이어는 활동 후 실시간으로 반응 상태 변화를 확인하며 다음 활동 전략을 구상한다.
  4.  **(반복):** 제한 시간/기회가 소진될 때까지 2-3 단계를 반복한다.
  5.  **결과 확인 (결과 씬):**
      - 제한 시간/기회가 모두 소진되면 결과 씬으로 이동한다.
      - 미션 성공/실패 여부를 명확하게 텍스트와 시각 효과로 표시한다.
      - 달성한 반응 수치(좋아요, 팔로워 등), 인기 게시물 순위 등을 요약하여 보여준다.
      - **클라이언트/팔로워 피드백 (Should Have):** LLM이 생성한 클라이언트 또는 주요 팔로워의 평가/반응 메시지(DM 형태 등)를 표시한다.
      - 결과에 따라 다음 스토리 분기 또는 엔딩으로 이동하는 버튼을 제공한다.
  6.  **스토리 진행 (스토리 씬):** 미션 결과가 반영된 스토리가 진행된다. 성공 시 긍정적 전개(인지도 상승, 계약 성공 등), 실패 시 부정적 전개(계정 문제, 계약 실패 등) 또는 배드 엔딩 분기.
  7.  **엔딩:** 정해진 에피소드를 모두 완료하거나 특정 조건(배드 엔딩 조건 등)을 만족하면 해당 엔딩 씬으로 이동한다.
- **핵심 메카닉: 콘텐츠 게시 및 소셜 인터랙션 상세:**
  - **콘텐츠 게시:** 플레이어는 텍스트 입력 및 미리 준비된 이미지 목록에서 선택하여 게시물을 작성할 수 있다. 해시태그, 사용자 태그 기능 시뮬레이션.
  - **댓글/DM 작성:** 플레이어는 다른 게시물에 댓글을 달거나 DM을 보낼 수 있다.
  - **키워드/조건 체크 (Must Have):** 플레이어 활동(게시물, 댓글) 시, 시스템은 해당 콘텐츠가 미션에서 요구하는 키워드/해시태그를 포함하는지, 특정 조건(예: 특정 인물 태그)을 만족하는지 판별한다.
  - **기본 반응 변화 (Must Have):** 키워드/조건 충족 여부에 따라 기본적인 반응 수치(좋아요, 댓글 수, 팔로워)가 증감한다. (예: 필수 해시태그 포함 시 좋아요 +10, 조건 미충족 시 변화 없음 등 단순 로직)
  - **상세 평가 시스템 (Should Have):** LLM을 사용하여 플레이어 콘텐츠/댓글의 '매력도', '주제 적합성', '바이럴 가능성' 등을 점수화한다.
    - **매력도:** 콘텐츠가 사용자의 흥미를 끄는가? (이미지/텍스트 퀄리티, 감성 등 평가)
    - **주제 적합성:** 콘텐츠가 현재 트렌드나 미션 주제에 맞는가? (키워드, 맥락 등 평가)
    - **바이럴 가능성:** 콘텐츠가 공유되거나 널리 퍼질 가능성이 있는가? (독창성, 공감대, 정보성 등 평가)
  - **상세 반응 변화 (Should Have):** 상세 평가 점수를 기반으로 반응 수치를 보다 복잡하고 현실적으로 변화시킨다. (예: 매력도 높으면 좋아요/팔로워 크게 증가, 주제 부적합 시 반응 저조 등)
  - **AI 반응 생성 (Should Have):** 현재 상황, 플레이어 활동 내용 등을 바탕으로, LLM이 다양한 반응(긍정 댓글, 부정 댓글, 질문 DM, 팔로우/언팔로우 등)의 AI 인터랙션을 생성하여 피드/DM 목록에 추가한다.
  - **인기 게시물/알고리즘 시스템 (Should Have):** 게시물에 가상의 '노출 점수'를 부여하고, 플레이어 활동 및 AI 반응 결과에 따라 점수를 변동시켜 인기 게시물(피드 상단 노출 등) 순위를 동적으로 업데이트한다.

---

## 2. 게임 시스템 상세

- **LLM 기반 인스타그램 반응/영향력 시뮬레이션 시스템 상세:**
  - **콘텐츠/댓글 분석/평가:**
    - (Must Have) 키워드/조건 포함 여부 판별 로직.
    - (Should Have) LLM 기반 상세 평가 (매력도, 주제 적합성, 바이럴 가능성) 로직. 프롬프트 설계가 중요하며, 일관된 평가 기준 유지가 필요하다. (TDD의 AI 통합 섹션 참조)
  - **반응 변화 로직:**
    - (Must Have) 기본 점수 기반 반응(좋아요, 댓글 수, 팔로워) 증감 로직.
    - (Should Have) 상세 평가 점수 기반 복합 반응 변화 로직. 시간에 따른 자연 감소/증가, 팔로워 규모에 따른 영향력 차등 등 고려 가능.
  - **AI 반응 생성:**
    - (Should Have) 현재 상황, 플레이어 활동 내용, 미션 주제 등을 컨텍스트로 제공하여 LLM이 관련성 높고 다양한 톤의 댓글/DM을 생성하도록 프롬프트 설계. (예: 칭찬 댓글, 비판 댓글, 질문 DM, 협찬 제의 DM 등)
  - **인기 게시물/알고리즘 변화:**
    - (Should Have) 각 게시물에 가상의 '노출 점수' 또는 '인기 점수'를 부여하고, AI 반응 생성 및 플레이어 활동 평가 결과에 따라 수치를 변동시켜 인기 게시물 순위(피드 노출 순서 등)를 동적으로 업데이트한다.
  - **클라이언트/팔로워 피드백 생성:**
    - (Should Have) 미션 결과(성공/실패, 달성률 등) 및 플레이어 활동 내용을 컨텍스트로 제공하여 LLM이 클라이언트 또는 특정 팔로워의 말투와 성격에 맞는 피드백 메시지(DM 형태)를 생성하도록 프롬프트 설계.
- **저장/불러오기 시스템 상세:**
  - (Must Have) 최소 1개 슬롯 지원. 게임 진행 상태(현재 스토리 ID, 완료된 미션, 현재 여론 상태 등 주요 변수)를 저장하고 로드할 수 있어야 한다. 저장 시점은 플레이어 선택 또는 특정 구간 자동 저장 방식 고려.
  - (Should Have) 4개 슬롯 지원. 각 슬롯별 저장 시간, 현재 에피소드/챕터 정보, 팔로워 수 등을 표시하여 플레이어가 쉽게 구분하도록 한다. 저장 데이터는 로컬 스토리지 또는 Electron 환경의 경우 파일 시스템 활용 고려.
- **언어 변경 시스템 상세:**
  - (Should Have) 게임 내 텍스트(UI, 대사, 미션 설명 등)를 다국어 JSON 또는 유사한 형태로 분리하여 관리한다. 설정 메뉴에서 언어(한국어, 영어, 중국어) 선택 시 해당 언어 데이터로 교체하여 표시한다. LLM 프롬프트도 선택된 언어에 맞게 조정 필요.
- **에피소드/미션 관리 시스템 상세:**
  - 에피소드 진행 방식(선형적, 분기 허용 등) 정의 필요.
  - 미션 데이터(JSON) 구조 정의: 미션 ID, 제목, 목표 반응(좋아요, 팔로워 등), 조건(해시태그, 태그 등), 키워드, 제한 시간/기회, 초기 반응 상태, 초기 피드/DM 목록, 관련 스토리 ID 등을 포함해야 한다.
  - 완료된 미션 상태를 추적하고, 다음 진행 가능한 에피소드/미션을 결정하는 로직 필요.

---

## 3. UI/UX 상세 (User Interface / User Experience)

_(모든 UI 요소는 시각 디자인 가이드(`document/visualStyleGuide.md`)에 정의된 **도트(Pixel Art) 스타일**을 따른다.)_

- **타이틀 씬 (`TitleScreen.tsx`):**
  - 게임 로고 (도트 스타일) 중앙 배치.
  - '시작하기', '불러오기', '설정', '종료' 버튼 (도트 스타일 `PixelButton`) 배치.
  - 배경 이미지 (도트 스타일).
- **스토리 씬 (`StoryScene.tsx`):**
  - **배경:** 현재 장면에 맞는 도트 배경 이미지 표시 (`Background.tsx`).
  - **캐릭터:** 현재 대사 중인 캐릭터 또는 장면에 등장하는 캐릭터의 도트 스프라이트 표시 (`Character.tsx`). 감정 변화에 따른 스프라이트 교체 기능.
  - **대화창 (`DialogueBox.tsx`):** 화면 하단 또는 중앙에 배치. 캐릭터 이름과 대사 텍스트(픽셀 폰트) 표시. 텍스트 타이핑 효과(선택적).
  - **선택지 (`Choices.tsx`):** 스토리 분기점에서 선택지 버튼(도트 스타일) 목록 표시. 선택 시 시각적 피드백.
  - **시스템 메뉴:** 화면 구석(예: 우측 상단)에 설정 아이콘 버튼 배치. 클릭 시 설정 메뉴(`SettingsMenu.tsx`) 팝업.
  - **인스타그램 활동 씬 (`InstagramActivityScene.tsx` - 가칭):**
    - **전체 레이아웃:** 인스타그램 앱(피드, 스토리 뷰어, 프로필 등) 형태를 도트 스타일로 표현. 탭 전환 또는 화면 전환 방식 고려.
    - **미션 패널 (`MissionPanel.tsx`):** 화면 한 켠(예: 상단 또는 사이드바)에 고정 또는 토글 가능하게 표시. 미션 목표, 남은 기회/시간, 키워드/조건 등 표시.
    - **반응 통계 (`ReactionStats.tsx` - 가칭):** 좋아요, 댓글, 팔로워 수 등을 도트 스타일 아이콘과 숫자로 명확하게 표시. 실시간 업데이트 반영.
    - **피드/댓글/DM 리스트 (`InstagramFeed.tsx`, `InstagramCommentList.tsx` - 가칭):** 스크롤 가능한 영역. 각 게시물/댓글/DM은 컨테이너(도트 카드 스타일) 안에 사용자 이름, 내용, 시간, 좋아요/댓글 아이콘 등 포함. 인기 게시물은 상단 노출 또는 특별 표시.
    - **콘텐츠 게시/입력 (`InstagramPostInput.tsx` - 가칭):** 게시물 작성 시 텍스트 입력 필드, 이미지 선택 버튼, 해시태그/태그 입력 필드, '게시' 버튼 제공. 댓글/DM 작성 시 해당 인터페이스 제공.
- **결과 씬 (`ResultScene.tsx`):**
  - 미션 성공/실패 텍스트(크고 명확한 픽셀 폰트) 및 관련 도트 이미지/효과 표시 (예: 팔로워 증가 이펙트).
  - 달성 결과 요약 (획득 좋아요/팔로워 수, 인기 게시물 순위 등) 텍스트 표시.
  - 클라이언트/팔로워 피드백 메시지 표시 영역 (DM 형태, 필요시 스크롤 가능).
  - '다음으로' 또는 '메인으로' 버튼 (도트 스타일).
- **설정 메뉴 (`SettingsMenu.tsx`):**
  - 팝업 형태 (도트 카드/창 스타일).
  - 볼륨 조절 슬라이더 (도트 스타일), 언어 선택 드롭다운/버튼 (도트 스타일), 저장/불러오기 버튼, 타이틀로 가기 버튼 등 포함.
- **저장/불러오기 화면:**
  - 슬롯 목록 (도트 카드 스타일). 각 슬롯에 저장 시간, 챕터 정보 등 표시.
  - '저장', '불러오기', '삭제' 버튼 제공. 확인 팝업(도트 스타일) 포함.
- **엔딩 씬:** 엔딩 내용(텍스트, 이미지)에 맞는 도트 그래픽 연출. 크레딧 롤(선택적).

---

## 4. 콘텐츠 상세

- **에피소드 구성 상세:**
  - 각 에피소드는 명확한 시작과 끝을 가지며, 특정 주제나 사건을 다룬다.
  - 에피소드 내 미션은 1개 이상 포함될 수 있다.
  - 에피소드 흐름: `[스토리 씬(인트로)] -> [댓글알바 씬(미션 수행)] -> [스토리 씬(결과 반영)] -> [결과 씬(미션 결과 요약)] -> [다음 에피소드 또는 분기]`
  - 에피소드 데이터 구조 정의 필요 (JSON 형식, 에피소드 ID, 제목, 관련 스토리 ID 목록, 포함된 미션 ID 목록 등).
- **미션 데이터 구조 상세 (`missions.json` 예시):**
  ```json
  [
    {
      "id": "mission_insta_01",
      "title": "신상 뷰티템 홍보 게시물 올리기",
      "targetReactions": { "likes": 1000, "followers": 50 }, // 목표: 좋아요 1000개, 팔로워 50명 증가
      "targetPopularityRank": 5, // 목표: 인기 게시물 5위 안에 들기 (선택적)
      "keywords": ["#신상뷰티", "#인생템"], // 필수 포함 해시태그
      "conditions": ["제품 사용 인증샷 포함", "@브랜드계정 태그"], // 콘텐츠 조건
      "initialReactions": { "likes": 150, "comments": 10, "followers": 2000 },
      "maxPosts": 1, // 최대 게시물 작성 기회
      "maxDMs": 3, // 최대 DM 발송 기회
      "timeLimitSeconds": 300, // 제한 시간 (초, 0이면 무제한)
      "initialFeed": [
        // 초기 피드/댓글/DM 목록 (AI 생성 또는 미리 작성)
        {
          "id": "post_001",
          "type": "post",
          "user": "뷰티스타",
          "text": "요즘 핫한 OOO쿠션 써봤는데...",
          "image": "img_beauty_01",
          "likes": 850,
          "comments": [{ "user": "코덕", "text": "와 진짜 좋아보여요!" }]
        }
        // ... (다른 게시물, 댓글, DM 추가)
      ],
      "llmParams": {
        // LLM 평가/생성 관련 파라미터
        "attractivenessRange": [1, 10], // 매력도 점수 범위
        "relevanceRange": [1, 10], // 주제 적합성 점수 범위
        "viralityRange": [1, 10], // 바이럴 가능성 점수 범위
        "evaluationCriteria": ["attractiveness", "relevance", "virality"] // 상세 평가 시 기준
      },
      "relatedStoryIds": {
        // 미션 전후 스토리 ID
        "briefing": "story_insta_005",
        "success": "story_insta_006_success",
        "failure": "story_insta_006_failure"
      }
    }
    // ... (다른 미션 데이터)
  ]
  ```
- **스토리 스크립트 데이터 구조 상세 (`script.json` 예시):**
  ```json
  {
    "story_insta_001": {
      "type": "dialogue", // 대화 타입
      "character": "주인공", // 화자
      "text": "오늘 인스타 피드 좀 볼까...",
      "background": "bg_room_day", // 배경 이미지 ID
      "sprite": "char_player_idle", // 캐릭터 스프라이트 ID
      "next": "story_insta_002" // 다음 스토리 ID
    },
    "story_insta_002": {
      "type": "monologue", // 독백 타입
      "text": "(DM 알림이 왔다. 유명 뷰티 브랜드 담당자다!)",
      "next": "story_insta_003"
    },
    "story_insta_003": {
      "type": "dialogue", // DM 형태의 대화
      "character": "뷰티담당자", // 상대방
      "sprite": "char_client_beauty", // 담당자 스프라이트 ID
      "text": "안녕하세요! 저희 신제품 협찬 관련해서 연락드렸습니다.",
      "next": "story_insta_004"
    },
    "story_insta_004": {
      "type": "choices", // 선택지 타입
      "text": "어떻게 답장할까?",
      "choices": [
        { "text": "네! 자세한 내용 부탁드려요.", "next": "story_insta_005" }, // 미션 브리핑으로 연결
        {
          "text": "죄송하지만 지금은 어려울 것 같아요.",
          "next": "story_insta_alternative_route"
        } // 다른 스토리 분기
      ]
    }
    // ... (미션 브리핑, 결과 반영 스토리 등 추가)
  }
  ```
- **향후 에피소드 아이디어:** (뷰티, 패션, 여행, 음식 등 다양한 인스타그램 주제, 인플루언서 간의 경쟁, 광고 협찬 논란, 뒷광고 문제 등 현실적인 이슈 반영 고려)

---
